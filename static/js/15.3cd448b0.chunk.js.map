{"version":3,"sources":["nft/utils/roundAndPluralize.ts","nft/utils/x2y2.ts","nft/utils/listNfts.ts","nft/components/sell/modal/ListingSection.tsx","nft/components/sell/modal/ListingModal.tsx"],"names":["roundAndPluralize","i","word","rounded","Math","floor","pluralize","number","orderItemParamType","orderParamTypes","orderParamType","signOrderData","web3Provider","order","a","orderData","defaultAbiCoder","encode","salt","user","network","intent","delegateType","deadline","currency","dataMask","items","length","orderHash","keccak256","send","orderSig","r","slice","s","v","parseInt","fixSignature","data","encodeOrder","createSellOrder","randomHex","BigNumber","from","randomBytes","toHexString","hexZeroPad","randomSalt","AddressZero","map","item","price","tokens","signVersion","ListingMarkets","name","fee","icon","createConsiderationItem","basisPoints","recipient","amount","getConsiderationItems","asset","signerAddress","openSeaBasisPoints","OPENSEA_DEFAULT_FEE","INVERSE_BASIS_POINTS","creatorFeeBasisPoints","creatorPercentage","sellerBasisPoints","openseaFee","mul","div","toString","creatorFee","sellerFee","OPENSEA_FEE_ADDRESS","asset_contract","payout_address","undefined","approveCollection","operator","collectionAddress","signer","setStatus","ERC721Contract","Contract","ERC721","getAddress","ListingStatus","PENDING","isApprovedForAll","APPROVED","SIGNING","setApprovalForAll","approvalTransaction","wait","status","FAILED","code","REJECTED","signListing","marketplace","provider","looksRareNonce","seaport","Seaport","conduitKeyToConduit","OPENSEA_KEY_TO_CONDUIT","overrides","defaultConduitKey","OPENSEA_DEFAULT_CROSS_CHAIN_CONDUIT_KEY","listingPrice","newListings","find","listing","expirationTime","listingInWei","parseEther","considerationItems","filter","createOrder","offer","itemType","ItemType","token","address","identifier","tokenId","consideration","endTime","zone","OPENSEA_DEFAULT_ZONE","restrictedByZone","allowPartialFills","executeAllActions","PostOpenSeaSellOrder","OPENSEA_LISTINGS_API_PATH","addresses","addressesByNetwork","SupportedChainId","MAINNET","currentTime","round","Date","now","makerOrder","isOrderAsk","collection","strategy","STRATEGY_STANDARD_SALE","WETH","nonce","startTime","minPercentageToAsk","sub","add","toNumber","params","signMakerOrder","process","REACT_APP_LOOKSRARE_MARKETPLACE_CONTRACT","signatureHash","payload","signature","createLooksRareOrder","res","orderItem","parseFloat","isBundle","bundleName","bundleDesc","orderIds","changePrice","isCollection","newX2Y2Order","resp","ListingSection","sectionTitle","caption","title","rows","index","openIndex","isSuccessScreen","useState","isOpen","setIsOpen","notAllApproved","some","row","sellAssets","useSellAsset","state","removeAssetMarketplace","removeRow","getListingRowPrice","listingRow","useEffect","allApproved","flexWrap","className","subhead","marginTop","marginBottom","onClick","color","style","marginRight","clsx","styles","gap","width","paddingTop","Box","fontWeight","badge","images","image","as","height","borderRadius","zIndex","src","alt","marginLeft","textOverflow","overflow","maxWidth","sm","md","bodySmall","formatEthPrice","numberToWei","fontSize","stroke","justifyContent","buttonTextSmall","border","cursor","backgroundColor","e","stopPropagation","callback","ListingModal","useWeb3React","getSigner","listings","useNFTList","setListings","collectionsRequiringApproval","setCollectionsRequiringApproval","setOpenIndex","listingStatus","setListingStatus","allCollectionsApproved","setAllCollectionsApproved","setLooksRareNonce","getLooksRareNonce","toggleCart","useBag","toggleBag","looksRareNonceRef","useRef","isMobile","useIsMobile","subscribe","current","totalEthListingValue","useMemo","getTotalEthValue","every","CONTINUE","signListings","startListingFlow","looksRareNonceFetcher","PAUSED","looksRareAddress","TRANSFER_MANAGER_ERC721","collectionRow","verifyStatus","approveCollectionRow","pauseAllRows","signListingRow","allListingsSigned","paused","logListing","pauseRow","showSuccessScreen","paddingBottom","paddingLeft","paddingRight","headlineSmall","display","fill","themeVars","colors","textPrimary","overflowX","overflowY","maxHeight","subheadSmall","ListingButton","resetRow","resetAllRows","buttonText","showWarningOverride","type"],"mappings":"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","file":"static/js/15.3cd448b0.chunk.js","sourcesContent":["export const roundAndPluralize = (i: number, word: string) => {\n  const rounded = Math.floor(i)\n\n  return `${rounded} ${word}${rounded === 1 ? '' : 's'}`\n}\n\nexport const pluralize = (number: number) => (number !== 1 ? 's' : '')\n","import { defaultAbiCoder } from '@ethersproject/abi'\nimport { BigNumber, BigNumberish } from '@ethersproject/bignumber'\nimport { hexZeroPad } from '@ethersproject/bytes'\nimport { AddressZero } from '@ethersproject/constants'\nimport { keccak256 } from '@ethersproject/keccak256'\nimport type { Web3Provider } from '@ethersproject/providers'\nimport { randomBytes } from '@ethersproject/random'\n\nconst dataParamType = `tuple(address token, uint256 tokenId)[]`\nconst orderItemParamType = `tuple(uint256 price, bytes data)`\nconst orderParamTypes = [\n  `uint256`,\n  `address`,\n  `uint256`,\n  `uint256`,\n  `uint256`,\n  `uint256`,\n  `address`,\n  `bytes`,\n  `uint256`,\n  `${orderItemParamType}[]`,\n]\nconst orderParamType = `tuple(uint256 salt, address user, uint256 network, uint256 intent, uint256 delegateType, uint256 deadline, address currency, bytes dataMask, ${orderItemParamType}[] items, bytes32 r, bytes32 s, uint8 v, uint8 signVersion)`\n\nexport type OfferItem = {\n  price: BigNumber\n  tokens: {\n    token: string\n    tokenId: BigNumberish\n  }[]\n}\n\ntype OrderItem = {\n  price: BigNumberish\n  data: string\n}\n\ntype Order = {\n  salt: BigNumberish\n  user: string\n  network: BigNumberish\n  intent: BigNumberish\n  delegateType: BigNumberish\n  deadline: BigNumberish\n  currency: string\n  dataMask: string\n  items: OrderItem[]\n  // signature\n  r: string\n  s: string\n  v: number\n  signVersion: number\n}\n\nexport type OrderPayload = {\n  order: string\n  isBundle: boolean\n  bundleName: string\n  bundleDesc: string\n  orderIds: number[]\n  changePrice: boolean\n  isCollection: boolean\n}\n\nexport type OrderResp = {\n  success: boolean\n  code: number\n  error?: string\n}\n\nconst randomSalt = () => {\n  const randomHex = BigNumber.from(randomBytes(16)).toHexString()\n  return hexZeroPad(randomHex, 64)\n}\n\nconst encodeItemData = (data: { token: string; tokenId: BigNumberish }[]) => {\n  return defaultAbiCoder.encode([dataParamType], [data])\n}\n\nexport const signOrderData = async (web3Provider: Web3Provider, order: Order) => {\n  const orderData = defaultAbiCoder.encode(orderParamTypes, [\n    order.salt,\n    order.user,\n    order.network,\n    order.intent,\n    order.delegateType,\n    order.deadline,\n    order.currency,\n    order.dataMask,\n    order.items.length,\n    order.items,\n  ])\n  const orderHash = keccak256(orderData)\n  const orderSig = (await web3Provider.send('personal_sign', [orderHash, order.user])) as string\n  order.r = `0x${orderSig.slice(2, 66)}`\n  order.s = `0x${orderSig.slice(66, 130)}`\n  order.v = parseInt(orderSig.slice(130, 132), 16)\n  fixSignature(order)\n}\n\nconst fixSignature = (data: Order) => {\n  // in geth its always 27/28, in ganache its 0/1. Change to 27/28 to prevent\n  // signature malleability if version is 0/1\n  // see https://github.com/ethereum/go-ethereum/blob/v1.8.23/internal/ethapi/api.go#L465\n  if (data.v < 27) {\n    data.v = data.v + 27\n  }\n}\n\nexport const encodeOrder = (order: Order): string => {\n  return defaultAbiCoder.encode([orderParamType], [order])\n}\n\nexport const createSellOrder = (user: string, deadline: number, items: OfferItem[]): Order => {\n  const salt = randomSalt()\n  const network = 1 // mainnet\n  const intent = 1 // INTENT_SELL\n  const delegateType = 1 // DELEGATION_TYPE_ERC721\n  const currency = AddressZero // ETH\n  return {\n    salt,\n    user,\n    network,\n    intent,\n    delegateType,\n    deadline,\n    currency,\n    dataMask: '0x',\n    items: items.map((item) => ({\n      price: item.price,\n      data: encodeItemData(item.tokens),\n    })),\n    r: '',\n    s: '',\n    v: 0,\n    signVersion: 1,\n  }\n}\n","import { Signer } from '@ethersproject/abstract-signer'\nimport { BigNumber } from '@ethersproject/bignumber'\nimport { Contract } from '@ethersproject/contracts'\nimport type { JsonRpcSigner, Web3Provider } from '@ethersproject/providers'\nimport { parseEther } from '@ethersproject/units'\nimport { addressesByNetwork, MakerOrder, signMakerOrder, SupportedChainId } from '@looksrare/sdk'\nimport { Seaport } from '@opensea/seaport-js'\nimport { ItemType } from '@opensea/seaport-js/lib/constants'\nimport { ConsiderationInputItem } from '@opensea/seaport-js/lib/types'\nimport {\n  OPENSEA_DEFAULT_CROSS_CHAIN_CONDUIT_KEY,\n  OPENSEA_DEFAULT_ZONE,\n  OPENSEA_KEY_TO_CONDUIT,\n  OPENSEA_LISTINGS_API_PATH,\n} from 'nft/queries/openSea'\n\nimport ERC721 from '../../abis/erc721.json'\nimport { createLooksRareOrder, newX2Y2Order, PostOpenSeaSellOrder } from '../queries'\nimport { INVERSE_BASIS_POINTS, OPENSEA_DEFAULT_FEE, OPENSEA_FEE_ADDRESS } from '../queries/openSea'\nimport { ListingMarket, ListingStatus, WalletAsset } from '../types'\nimport { createSellOrder, encodeOrder, OfferItem, OrderPayload, signOrderData } from './x2y2'\n\nexport const ListingMarkets: ListingMarket[] = [\n  {\n    name: 'LooksRare',\n    fee: 2.0,\n    icon: '/nft/svgs/marketplaces/looksrare.svg',\n  },\n  {\n    name: 'OpenSea',\n    fee: 2.5,\n    icon: '/nft/svgs/marketplaces/opensea.svg',\n  },\n  {\n    name: 'X2Y2',\n    fee: 0.5,\n    icon: '/nft/svgs/marketplaces/x2y2.svg',\n  },\n]\n\nconst createConsiderationItem = (basisPoints: string, recipient: string): ConsiderationInputItem => {\n  return {\n    amount: basisPoints,\n    recipient,\n  }\n}\n\nconst getConsiderationItems = (\n  asset: WalletAsset,\n  price: BigNumber,\n  signerAddress: string\n): {\n  sellerFee: ConsiderationInputItem\n  openseaFee: ConsiderationInputItem\n  creatorFee?: ConsiderationInputItem\n} => {\n  const openSeaBasisPoints = OPENSEA_DEFAULT_FEE * INVERSE_BASIS_POINTS\n  const creatorFeeBasisPoints = asset.creatorPercentage * INVERSE_BASIS_POINTS\n  const sellerBasisPoints = INVERSE_BASIS_POINTS - openSeaBasisPoints - creatorFeeBasisPoints\n\n  const openseaFee = price.mul(BigNumber.from(openSeaBasisPoints)).div(BigNumber.from(INVERSE_BASIS_POINTS)).toString()\n  const creatorFee = price\n    .mul(BigNumber.from(creatorFeeBasisPoints))\n    .div(BigNumber.from(INVERSE_BASIS_POINTS))\n    .toString()\n  const sellerFee = price.mul(BigNumber.from(sellerBasisPoints)).div(BigNumber.from(INVERSE_BASIS_POINTS)).toString()\n\n  return {\n    sellerFee: createConsiderationItem(sellerFee, signerAddress),\n    openseaFee: createConsiderationItem(openseaFee, OPENSEA_FEE_ADDRESS),\n    creatorFee:\n      creatorFeeBasisPoints > 0 ? createConsiderationItem(creatorFee, asset.asset_contract.payout_address) : undefined,\n  }\n}\n\nexport async function approveCollection(\n  operator: string,\n  collectionAddress: string,\n  signer: Signer,\n  setStatus: (newStatus: ListingStatus) => void\n): Promise<void> {\n  // This will work for both 721s & 1155s because they both have the\n  // setApprovalForAll() method\n  const ERC721Contract = new Contract(collectionAddress, ERC721, signer)\n  const signerAddress = await signer.getAddress()\n  setStatus(ListingStatus.PENDING)\n  try {\n    const approved = await ERC721Contract.isApprovedForAll(signerAddress, operator)\n    if (approved) {\n      setStatus(ListingStatus.APPROVED)\n      return\n    }\n\n    setStatus(ListingStatus.SIGNING)\n    const approvalTransaction = await ERC721Contract.setApprovalForAll(operator, true)\n\n    setStatus(ListingStatus.PENDING)\n    const tx = await approvalTransaction.wait()\n\n    tx.status === 1 ? setStatus(ListingStatus.APPROVED) : setStatus(ListingStatus.FAILED)\n  } catch (error) {\n    if (error.code === 4001) setStatus(ListingStatus.REJECTED)\n    else setStatus(ListingStatus.FAILED)\n  }\n}\n\nexport async function signListing(\n  marketplace: ListingMarket,\n  asset: WalletAsset,\n  signer: JsonRpcSigner,\n  provider: Web3Provider,\n  looksRareNonce = 0,\n  setStatus: (newStatus: ListingStatus) => void\n): Promise<boolean> {\n  const seaport = new Seaport(provider, {\n    conduitKeyToConduit: OPENSEA_KEY_TO_CONDUIT,\n    overrides: {\n      defaultConduitKey: OPENSEA_DEFAULT_CROSS_CHAIN_CONDUIT_KEY,\n    },\n  })\n\n  const signerAddress = await signer.getAddress()\n  const listingPrice = asset.newListings?.find((listing) => listing.marketplace.name === marketplace.name)?.price\n  if (!listingPrice || !asset.expirationTime) return false\n  switch (marketplace.name) {\n    case 'OpenSea':\n      try {\n        const listingInWei = parseEther(`${listingPrice}`)\n        const { sellerFee, openseaFee, creatorFee } = getConsiderationItems(asset, listingInWei, signerAddress)\n        const considerationItems = [sellerFee, openseaFee, creatorFee].filter(\n          (item): item is ConsiderationInputItem => item !== undefined\n        )\n\n        const { executeAllActions } = await seaport.createOrder(\n          {\n            offer: [\n              {\n                itemType: ItemType.ERC721,\n                token: asset.asset_contract.address,\n                identifier: asset.tokenId,\n                amount: '1',\n              },\n            ],\n            consideration: considerationItems,\n            endTime: asset.expirationTime.toString(),\n            zone: OPENSEA_DEFAULT_ZONE,\n            restrictedByZone: true,\n            allowPartialFills: true,\n          },\n          signerAddress\n        )\n\n        const order = await executeAllActions()\n        const res = await PostOpenSeaSellOrder(OPENSEA_LISTINGS_API_PATH, order)\n        if (res) setStatus(ListingStatus.APPROVED)\n        return true\n      } catch (error) {\n        if (error.code === 4001) setStatus(ListingStatus.REJECTED)\n        else setStatus(ListingStatus.FAILED)\n        return false\n      }\n    case 'LooksRare':\n      const addresses = addressesByNetwork[SupportedChainId.MAINNET]\n      const currentTime = Math.round(Date.now() / 1000)\n      const makerOrder: MakerOrder = {\n        // true --> ask / false --> bid\n        isOrderAsk: true,\n        // signer address of the maker order\n        signer: signerAddress,\n        // collection address\n        collection: asset.asset_contract.address,\n        // Price in WEI\n        price: parseEther(listingPrice.toString()),\n        // Token ID\n        tokenId: BigNumber.from(asset.tokenId),\n        // amount of tokens to sell/purchase (must be 1 for ERC721, 1+ for ERC1155)\n        amount: BigNumber.from(1),\n        // strategy for trade execution (e.g., DutchAuction, StandardSaleForFixedPrice), see addresses in the SDK\n        strategy: addresses.STRATEGY_STANDARD_SALE,\n        // currency address\n        currency: addresses.WETH,\n        // order nonce (must be unique unless new maker order is meant to override existing one e.g., lower ask price)\n        nonce: BigNumber.from(looksRareNonce),\n        // startTime timestamp in seconds\n        startTime: BigNumber.from(currentTime),\n        // endTime timestamp in seconds\n        endTime: BigNumber.from(asset.expirationTime),\n        // minimum ratio to be received by the user (per 10000)\n        minPercentageToAsk: BigNumber.from(10000)\n          .sub(BigNumber.from(200).add(BigNumber.from(asset.creatorPercentage * 10000)))\n          .toNumber(),\n        // params (e.g., price, target account for private sale)\n        params: [],\n      }\n\n      try {\n        const signatureHash = await signMakerOrder(\n          signer,\n          SupportedChainId.MAINNET,\n          makerOrder,\n          process.env.REACT_APP_LOOKSRARE_MARKETPLACE_CONTRACT || ''\n        )\n        setStatus(ListingStatus.PENDING)\n        const payload = {\n          signature: signatureHash,\n          tokenId: asset.tokenId,\n          collection: asset.asset_contract.address,\n          strategy: addresses.STRATEGY_STANDARD_SALE,\n          currency: addresses.WETH,\n          signer: signerAddress,\n          isOrderAsk: true,\n          nonce: looksRareNonce,\n          amount: 1,\n          price: parseEther(listingPrice.toString()).toString(),\n          startTime: currentTime,\n          endTime: asset.expirationTime,\n          minPercentageToAsk: 10000 - (200 + asset.creatorPercentage * 10000),\n          params: [],\n        }\n        const res = await createLooksRareOrder(payload)\n        if (res) setStatus(ListingStatus.APPROVED)\n        return res\n      } catch (error) {\n        if (error.code === 4001) setStatus(ListingStatus.REJECTED)\n        else setStatus(ListingStatus.FAILED)\n        return false\n      }\n\n    case 'X2Y2':\n      const orderItem: OfferItem = {\n        price: parseEther(listingPrice.toString()),\n        tokens: [\n          {\n            token: asset.asset_contract.address,\n            tokenId: BigNumber.from(parseFloat(asset.tokenId)),\n          },\n        ],\n      }\n      const order = createSellOrder(signerAddress, asset.expirationTime, [orderItem])\n      try {\n        await signOrderData(provider, order)\n        const payload: OrderPayload = {\n          order: encodeOrder(order),\n          isBundle: false,\n          bundleName: '',\n          bundleDesc: '',\n          orderIds: [],\n          changePrice: false,\n          isCollection: false,\n        }\n        setStatus(ListingStatus.PENDING)\n        // call server api\n        const resp = await newX2Y2Order(payload)\n        if (resp) setStatus(ListingStatus.APPROVED)\n        return resp\n      } catch (error) {\n        if (error.code === 4001) setStatus(ListingStatus.REJECTED)\n        else setStatus(ListingStatus.FAILED)\n        return false\n      }\n\n    default:\n      return false\n  }\n}\n","import clsx from 'clsx'\nimport { Box } from 'nft/components/Box'\nimport { Column, Row } from 'nft/components/Flex'\nimport { ApprovedCheckmarkIcon, ChevronUpIcon, FailedListingIcon, LoadingIcon } from 'nft/components/icons'\nimport { badge, bodySmall, buttonTextSmall, subhead } from 'nft/css/common.css'\nimport { useSellAsset } from 'nft/hooks'\nimport { AssetRow, CollectionRow, ListingRow, ListingStatus } from 'nft/types'\nimport { formatEthPrice, numberToWei } from 'nft/utils/currency'\nimport { useEffect, useState } from 'react'\n\nimport * as styles from './ListingModal.css'\n\nexport const ListingSection = ({\n  sectionTitle,\n  caption = undefined,\n  title = undefined,\n  rows,\n  index,\n  openIndex,\n  isSuccessScreen = false,\n}: {\n  sectionTitle: string\n  caption?: string\n  title?: string\n  rows: AssetRow[]\n  index: number\n  openIndex: number\n  isSuccessScreen?: boolean\n}) => {\n  const [isOpen, setIsOpen] = useState(false)\n  const notAllApproved = rows.some((row: AssetRow) => row.status !== ListingStatus.APPROVED)\n  const sellAssets = useSellAsset((state) => state.sellAssets)\n  const removeAssetMarketplace = useSellAsset((state) => state.removeAssetMarketplace)\n\n  const removeRow = (row: any) => {\n    // collections\n    if (index === 1) {\n      for (const asset of sellAssets)\n        if (asset.asset_contract.address === row.collectionAddress) removeAssetMarketplace(asset, row.marketplace)\n    }\n    // listings\n    else removeAssetMarketplace(row.asset, row.marketplace)\n  }\n\n  useEffect(() => {\n    setIsOpen(index === openIndex)\n  }, [index, openIndex])\n\n  function getListingRowPrice(row: AssetRow): number | undefined {\n    const listingRow = row as ListingRow\n    const newListings = listingRow.asset.newListings\n    return newListings?.find((listing) => listing.marketplace.name === listingRow.marketplace.name)?.price ?? 0\n  }\n\n  const allApproved = !notAllApproved && rows.length > 0 && !isSuccessScreen\n\n  return (\n    <Row\n      flexWrap=\"wrap\"\n      className={subhead}\n      marginTop=\"10\"\n      marginBottom=\"10\"\n      onClick={() => rows.length > 0 && setIsOpen(!isOpen)}\n      color={allApproved ? 'green' : 'textPrimary'}\n    >\n      {allApproved && <ApprovedCheckmarkIcon style={{ marginRight: '8px' }} />}\n      {sectionTitle}\n      {!isSuccessScreen && <ChevronUpIcon className={clsx(`${isOpen ? '' : styles.chevronDown} ${styles.chevron}`)} />}\n      {(isOpen || isSuccessScreen) && (\n        <Column\n          gap=\"12\"\n          width=\"full\"\n          paddingTop={isSuccessScreen ? '28' : 'auto'}\n          className={clsx(!isSuccessScreen && styles.listingSectionBorder)}\n        >\n          {caption && (\n            <Box color=\"textPrimary\" fontWeight=\"normal\" className={caption}>\n              {caption}\n            </Box>\n          )}\n          {title && (\n            <Box color=\"textSecondary\" className={badge}>\n              {title}\n            </Box>\n          )}\n          <Column gap=\"8\">\n            {rows.map((row: AssetRow, index) => {\n              return (\n                <Column key={index} gap=\"8\">\n                  <Row>\n                    {row.images.map((image, index) => {\n                      return (\n                        <Box\n                          as=\"img\"\n                          height=\"20\"\n                          width=\"20\"\n                          borderRadius={index === 0 && (row as CollectionRow).collectionAddress ? 'round' : '4'}\n                          style={{ zIndex: 2 - index }}\n                          className={styles.listingModalIcon}\n                          src={image}\n                          alt={row.name}\n                          key={index}\n                        />\n                      )\n                    })}\n                    <Box\n                      marginLeft=\"8\"\n                      marginRight=\"auto\"\n                      fontWeight=\"normal\"\n                      color=\"textPrimary\"\n                      textOverflow=\"ellipsis\"\n                      overflow=\"hidden\"\n                      maxWidth={{\n                        sm: 'max',\n                        md:\n                          row.status === ListingStatus.REJECTED || row.status === ListingStatus.FAILED ? '120' : 'full',\n                      }}\n                      className={bodySmall}\n                    >\n                      {row.name}\n                    </Box>\n                    {isSuccessScreen ? (\n                      getListingRowPrice(row) &&\n                      `${formatEthPrice(numberToWei(getListingRowPrice(row) ?? 0).toString())} ETH`\n                    ) : row.status === ListingStatus.APPROVED ? (\n                      <ApprovedCheckmarkIcon height=\"20\" width=\"20\" />\n                    ) : row.status === ListingStatus.FAILED || row.status === ListingStatus.REJECTED ? (\n                      <Row gap=\"4\">\n                        <Box fontWeight=\"normal\" fontSize=\"14\" color=\"textSecondary\">\n                          {row.status}\n                        </Box>\n                        <FailedListingIcon />\n                      </Row>\n                    ) : (\n                      row.status === ListingStatus.SIGNING && <LoadingIcon height=\"20\" width=\"20\" stroke=\"#4673FA\" />\n                    )}\n                  </Row>\n                  {(row.status === ListingStatus.FAILED || row.status === ListingStatus.REJECTED) && (\n                    <Row gap=\"8\" justifyContent=\"center\">\n                      <Box\n                        width=\"120\"\n                        as=\"button\"\n                        className={buttonTextSmall}\n                        borderRadius=\"12\"\n                        border=\"none\"\n                        color=\"red400\"\n                        height=\"32\"\n                        cursor=\"pointer\"\n                        style={{ backgroundColor: '#FA2B391A' }}\n                        onClick={async (e) => {\n                          e.stopPropagation()\n                          removeRow(row)\n                        }}\n                      >\n                        Remove\n                      </Box>\n                      <Box\n                        width=\"120\"\n                        as=\"button\"\n                        className={buttonTextSmall}\n                        borderRadius=\"12\"\n                        border=\"none\"\n                        color=\"genieBlue\"\n                        height=\"32\"\n                        cursor=\"pointer\"\n                        style={{ backgroundColor: '#4C82FB29' }}\n                        onClick={async (e) => {\n                          e.stopPropagation()\n                          if (row.callback) {\n                            await row.callback()\n                          }\n                        }}\n                      >\n                        Try again\n                      </Box>\n                    </Row>\n                  )}\n                </Column>\n              )\n            })}\n          </Column>\n        </Column>\n      )}\n    </Row>\n  )\n}\n","import { addressesByNetwork, SupportedChainId } from '@looksrare/sdk'\nimport { useWeb3React } from '@web3-react/core'\nimport { Box } from 'nft/components/Box'\nimport { Column, Row } from 'nft/components/Flex'\nimport { ChevronLeftIcon, XMarkIcon } from 'nft/components/icons'\nimport { caption, headlineSmall, subhead, subheadSmall } from 'nft/css/common.css'\nimport { themeVars } from 'nft/css/sprinkles.css'\nimport { useBag, useIsMobile, useNFTList, useSellAsset } from 'nft/hooks'\nimport { logListing, looksRareNonceFetcher } from 'nft/queries'\nimport { AssetRow, CollectionRow, ListingRow, ListingStatus } from 'nft/types'\nimport { pluralize } from 'nft/utils/roundAndPluralize'\nimport { Dispatch, useEffect, useMemo, useRef, useState } from 'react'\n\nimport { ListingButton } from './ListingButton'\nimport * as styles from './ListingModal.css'\nimport { ListingSection } from './ListingSection'\nimport { approveCollectionRow, getTotalEthValue, pauseRow, resetRow, signListingRow, verifyStatus } from './utils'\n\nconst ListingModal = () => {\n  const { provider } = useWeb3React()\n  const sellAssets = useSellAsset((state) => state.sellAssets)\n  const signer = provider?.getSigner()\n  const listings = useNFTList((state) => state.listings)\n  const setListings = useNFTList((state) => state.setListings)\n  const collectionsRequiringApproval = useNFTList((state) => state.collectionsRequiringApproval)\n  const setCollectionsRequiringApproval = useNFTList((state) => state.setCollectionsRequiringApproval)\n  const [openIndex, setOpenIndex] = useState(0)\n  const listingStatus = useNFTList((state) => state.listingStatus)\n  const setListingStatus = useNFTList((state) => state.setListingStatus)\n  const [allCollectionsApproved, setAllCollectionsApproved] = useState(false)\n  const looksRareNonce = useNFTList((state) => state.looksRareNonce)\n  const setLooksRareNonce = useNFTList((state) => state.setLooksRareNonce)\n  const getLooksRareNonce = useNFTList((state) => state.getLooksRareNonce)\n  const toggleCart = useBag((state) => state.toggleBag)\n  const looksRareNonceRef = useRef(looksRareNonce)\n  const isMobile = useIsMobile()\n\n  useEffect(() => {\n    useNFTList.subscribe((state) => (looksRareNonceRef.current = state.looksRareNonce))\n  }, [])\n\n  const totalEthListingValue = useMemo(() => getTotalEthValue(sellAssets), [sellAssets])\n\n  // when all collections have been approved, auto start the signing process\n  useEffect(() => {\n    collectionsRequiringApproval?.length &&\n      setAllCollectionsApproved(\n        collectionsRequiringApproval.every((collection: CollectionRow) => collection.status === ListingStatus.APPROVED)\n      )\n    if (\n      allCollectionsApproved &&\n      (listingStatus === ListingStatus.PENDING || listingStatus === ListingStatus.CONTINUE)\n    ) {\n      signListings()\n    }\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [collectionsRequiringApproval, allCollectionsApproved])\n\n  // handles the modal wide listing state based on conglomeration of the wallet, collection, and listing states\n\n  const startListingFlow = async () => {\n    if (!signer) return\n    setListingStatus(ListingStatus.SIGNING)\n    const addresses = addressesByNetwork[SupportedChainId.MAINNET]\n    const signerAddress = await signer.getAddress()\n    const nonce = await looksRareNonceFetcher(signerAddress)\n    setLooksRareNonce(nonce ?? 0)\n\n    if (!collectionsRequiringApproval?.some((collection) => collection.status === ListingStatus.PAUSED)) {\n      setListingStatus(ListingStatus.SIGNING)\n      setOpenIndex(1)\n    }\n    const looksRareAddress = addresses.TRANSFER_MANAGER_ERC721\n    // for all unqiue collection, marketplace combos -> approve collections\n    for (const collectionRow of collectionsRequiringApproval) {\n      verifyStatus(collectionRow.status) &&\n        approveCollectionRow(\n          collectionRow,\n          collectionsRequiringApproval,\n          setCollectionsRequiringApproval,\n          signer,\n          looksRareAddress,\n          pauseAllRows\n        )\n    }\n  }\n\n  const signListings = async () => {\n    if (!signer || !provider) return\n    setListingStatus(ListingStatus.SIGNING)\n    setOpenIndex(2)\n    // sign listings\n    for (const listing of listings) {\n      verifyStatus(listing.status) &&\n        (await signListingRow(\n          listing,\n          listings,\n          setListings,\n          signer,\n          provider,\n          getLooksRareNonce,\n          setLooksRareNonce,\n          pauseAllRows\n        ))\n    }\n    const allListingsSigned = listings.every((listing: ListingRow) => listing.status === ListingStatus.APPROVED)\n    const paused = listings.some((listing: ListingRow) => listing.status === ListingStatus.PAUSED)\n    if (allListingsSigned) {\n      setOpenIndex(0)\n      setListingStatus(ListingStatus.APPROVED)\n    } else if (!paused) {\n      setListingStatus(ListingStatus.FAILED)\n    }\n    await logListing(listings, (await signer?.getAddress()) ?? '')\n  }\n\n  const pauseAllRows = () => {\n    for (const collection of collectionsRequiringApproval) {\n      pauseRow(collection, collectionsRequiringApproval, setCollectionsRequiringApproval as Dispatch<AssetRow[]>)\n    }\n    for (const listing of listings) {\n      pauseRow(listing, listings, setListings as Dispatch<AssetRow[]>)\n    }\n  }\n\n  const resetAllRows = () => {\n    for (const collection of collectionsRequiringApproval) {\n      resetRow(collection, collectionsRequiringApproval, setCollectionsRequiringApproval as Dispatch<AssetRow[]>)\n    }\n    for (const listing of listings) {\n      resetRow(listing, listings, setListings as Dispatch<AssetRow[]>)\n    }\n  }\n\n  const clickStopListing = () => {\n    pauseAllRows()\n  }\n\n  const clickStartListingFlow = () => {\n    resetAllRows()\n    allCollectionsApproved ? signListings() : startListingFlow()\n  }\n\n  const showSuccessScreen = useMemo(() => listingStatus === ListingStatus.APPROVED, [listingStatus])\n\n  return (\n    <Column paddingTop=\"20\" paddingBottom=\"20\" paddingLeft=\"12\" paddingRight=\"12\">\n      <Row className={headlineSmall} marginBottom=\"10\">\n        {isMobile && !showSuccessScreen && (\n          <Box paddingTop=\"4\" marginRight=\"4\" onClick={toggleCart}>\n            <ChevronLeftIcon height={28} width={28} />\n          </Box>\n        )}\n        {showSuccessScreen ? 'Success!' : `Listing ${sellAssets.length} NFTs`}\n        <Box\n          as=\"button\"\n          border=\"none\"\n          color=\"textSecondary\"\n          backgroundColor=\"backgroundSurface\"\n          marginLeft=\"auto\"\n          marginRight=\"0\"\n          paddingRight=\"0\"\n          display={{ sm: 'flex', md: 'none' }}\n          cursor=\"pointer\"\n          onClick={toggleCart}\n        >\n          <XMarkIcon height={28} width={28} fill={themeVars.colors.textPrimary} />\n        </Box>\n      </Row>\n      <Column overflowX=\"hidden\" overflowY=\"auto\" style={{ maxHeight: '60vh' }}>\n        {showSuccessScreen ? (\n          <ListingSection\n            sectionTitle={`Listed ${listings.length} item${pluralize(listings.length)} for sale`}\n            rows={listings}\n            index={0}\n            openIndex={openIndex}\n            isSuccessScreen={true}\n          />\n        ) : (\n          <>\n            <ListingSection\n              sectionTitle={`Approve ${collectionsRequiringApproval.length} collection${pluralize(\n                collectionsRequiringApproval.length\n              )}`}\n              title=\"COLLECTIONS\"\n              rows={collectionsRequiringApproval}\n              index={1}\n              openIndex={openIndex}\n            />\n            <ListingSection\n              sectionTitle={`Confirm ${listings.length} listing${pluralize(listings.length)}`}\n              caption=\"Now you can sign to list each item\"\n              title=\"NFTS\"\n              rows={listings}\n              index={2}\n              openIndex={openIndex}\n            />\n          </>\n        )}\n      </Column>\n      <hr className={styles.sectionDivider} />\n      <Row className={subhead} marginTop=\"12\" marginBottom={showSuccessScreen ? '8' : '20'}>\n        Return if sold\n        <Row className={subheadSmall} marginLeft=\"auto\" marginRight=\"0\">\n          {totalEthListingValue}\n          &nbsp;ETH\n        </Row>\n      </Row>\n      {showSuccessScreen ? (\n        <Box as=\"span\" className={caption} color=\"textSecondary\">\n          Status:{' '}\n          <Box as=\"span\" color=\"green200\">\n            Confirmed\n          </Box>\n        </Box>\n      ) : (\n        <ListingButton onClick={clickStartListingFlow} buttonText={'Start listing'} showWarningOverride={isMobile} />\n      )}\n      {(listingStatus === ListingStatus.PENDING || listingStatus === ListingStatus.SIGNING) && (\n        <Box\n          as=\"button\"\n          border=\"none\"\n          backgroundColor=\"backgroundSurface\"\n          cursor=\"pointer\"\n          color=\"orange\"\n          className={styles.button}\n          onClick={clickStopListing}\n          type=\"button\"\n        >\n          Stop listing\n        </Box>\n      )}\n    </Column>\n  )\n}\n\nexport default ListingModal\n"],"sourceRoot":""}